============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-9.0.1, pluggy-1.6.0 -- D:\Dmarket\DMarket-Telegram-Bot\DMarket-Telegram-Bot\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: D:\Dmarket\DMarket-Telegram-Bot\DMarket-Telegram-Bot
configfile: pyproject.toml
plugins: anyio-4.11.0, Faker-38.0.0, asyncio-1.3.0, cov-7.0.0, mock-3.15.1, xdist-3.8.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collecting ... collected 10 items

tests/dmarket/test_api_unified.py::test_api_initialization PASSED        [ 10%]
tests/dmarket/test_api_unified.py::test_generate_headers PASSED          [ 20%]
tests/dmarket/test_api_unified.py::test_get_user_balance PASSED          [ 30%]
tests/dmarket/test_api_unified.py::test_get_user_balance_error PASSED    [ 40%]
tests/dmarket/test_api_unified.py::test_get_market_items PASSED          [ 50%]
tests/dmarket/test_api_unified.py::test_handle_rate_limit PASSED         [ 60%]
tests/dmarket/test_api_unified.py::test_api_timeout PASSED               [ 70%]
tests/dmarket/test_api_unified.py::test_parse_balance_format1 PASSED     [ 80%]
tests/dmarket/test_api_unified.py::test_parse_balance_format2 PASSED     [ 90%]
tests/dmarket/test_api_unified.py::test_parse_balance_empty PASSED       [100%]
ERROR: Coverage failure: total of 4.79 is less than fail-under=25.00


=============================== tests coverage ================================
_______________ coverage: platform win32, python 3.11.9-final-0 _______________

Name                                                         Stmts   Miss Branch BrPart  Cover   Missing
--------------------------------------------------------------------------------------------------------
src\dmarket\arbitrage_sales_analysis.py                        332    332    142      0  0.00%   13-990
src\dmarket\arbitrage_scanner.py                               478    478    172      0  0.00%   9-1522
src\dmarket\auto_arbitrage.py                                   31     31      6      0  0.00%   9-117
src\dmarket\filters\__init__.py                                  1      1      0      0  0.00%   3
src\dmarket\filters\game_filters.py                            102    102     64      0  0.00%   8-239
src\dmarket\game_filters.py                                      2      2      0      0  0.00%   7-17
src\dmarket\intramarket_arbitrage.py                           266    266    154      0  0.00%   10-733
src\dmarket\liquidity_analyzer.py                              140    140     36      0  0.00%   7-498
src\dmarket\liquidity_rules.py                                  27     27      8      0  0.00%   3-114
src\dmarket\market_analysis.py                                 260    260    108      0  0.00%   7-777
src\dmarket\models\__init__.py                                   1      1      0      0  0.00%   3
src\dmarket\models\market_models.py                            147    147      2      0  0.00%   9-345
src\dmarket\realtime_price_watcher.py                          273    273    106      0  0.00%   9-711
src\dmarket\sales_history.py                                   256    256     82      0  0.00%   9-786
src\dmarket\smart_market_finder.py                             297    297     96      0  0.00%   15-860
src\dmarket\targets.py                                         172    172     46      0  0.00%   14-624
src\main.py                                                     98     98      6      0  0.00%   7-218
src\models\__init__.py                                           2      2      0      0  0.00%   3-6
src\models\target.py                                            49     49      0      0  0.00%   3-185
src\models\trading.py                                           33     33      0      0  0.00%   3-122
src\models\user.py                                              67     67      0      0  0.00%   3-231
src\telegram_bot\arbitrage_scanner.py                          284    284    100      0  0.00%   9-873
src\telegram_bot\auto_arbitrage.py                             344    344    114      0  0.00%   9-1269
src\telegram_bot\auto_arbitrage_scanner.py                     229    229     86      0  0.00%   3-624
src\telegram_bot\commands\__init__.py                            1      1      0      0  0.00%   3
src\telegram_bot\commands\basic_commands.py                     16     16      4      0  0.00%   7-46
src\telegram_bot\constants.py                                   10     10      0      0  0.00%   4-39
src\telegram_bot\enhanced_auto_arbitrage.py                    108    108     46      0  0.00%   7-322
src\telegram_bot\game_filter_handlers.py                       287    287    110      0  0.00%   10-1166
src\telegram_bot\handlers\arbitrage_callback_impl.py           117    117     24      0  0.00%   10-537
src\telegram_bot\handlers\callbacks.py                         166    166     80      0  0.00%   6-564
src\telegram_bot\handlers\commands.py                           38     38     14      0  0.00%   7-172
src\telegram_bot\handlers\dmarket_handlers.py                   45     45     14      0  0.00%   6-128
src\telegram_bot\handlers\dmarket_status.py                     69     69     16      0  0.00%   1-144
src\telegram_bot\handlers\enhanced_arbitrage_handler.py        131    131     40      0  0.00%   3-459
src\telegram_bot\handlers\error_handlers.py                     29     29     12      0  0.00%   7-83
src\telegram_bot\handlers\intramarket_arbitrage_handler.py     131    131     30      0  0.00%   3-472
src\telegram_bot\handlers\market_alerts_handler.py             278    278    130      0  0.00%   7-823
src\telegram_bot\handlers\market_analysis_handler.py           310    310    120      0  0.00%   3-1068
src\telegram_bot\handlers\scanner_handler.py                   147    147     52      0  0.00%   3-511
src\telegram_bot\handlers\target_handler.py                     35     35     12      0  0.00%   3-132
src\telegram_bot\keyboards.py                                  249    249     76      0  0.00%   8-1452
src\telegram_bot\liquidity_settings_handler.py                 127    127     52      0  0.00%   3-459
src\telegram_bot\localization.py                                 1      1      0      0  0.00%   12
src\telegram_bot\market_alerts.py                              293    293    116      0  0.00%   8-783
src\telegram_bot\notifier.py                                   386    386    148      0  0.00%   10-1029
src\telegram_bot\pagination.py                                 149    149     68      0  0.00%   3-463
src\telegram_bot\price_alerts_handler.py                       131    131     18      0  0.00%   7-521
src\telegram_bot\profiles.py                                    25     25      4      0  0.00%   3-61
src\telegram_bot\register_all_handlers.py                       71     71      2      0  0.00%   7-152
src\telegram_bot\sales_analysis_callbacks.py                   212    212     62      0  0.00%   3-739
src\telegram_bot\sales_analysis_handlers.py                     98     98     12      0  0.00%   3-412
src\telegram_bot\settings_handlers.py                          159    159     44      0  0.00%   3-453
src\telegram_bot\smart_notifier.py                             369    369    128      0  0.00%   11-1234
src\telegram_bot\utils\formatters.py                           227    227     86      0  0.00%   7-658
src\utils\analytics.py                                         212    212     40      0  0.00%   7-577
src\utils\api_error_handling.py                                 41     41     22      0  0.00%   8-125
src\utils\exceptions.py                                        194    194     52      0  0.00%   7-646
src\utils\logging_utils.py                                      78     78     18      0  0.00%   8-344
src\utils\market_analyzer.py                                   296    296    144      0  0.00%   7-727
src\utils\market_visualizer.py                                 347    347    118      0  0.00%   12-868
src\utils\performance.py                                        96     96     22      0  0.00%   3-307
src\utils\price_analyzer.py                                    188    188     72      0  0.00%   10-531
src\utils\websocket_client.py                                  176    176     54      0  0.00%   7-404
src\dmarket\arbitrage.py                                       552    496    210      0  7.35%   77-87, 101-102, 125-158, 182-280, 303, 326, 349, 355-356, 361-362, 367-368, 393-483, 492-493, 527-560, 569-587, 591-596, 609-626, 630-648, 657-672, 695-802, 818-917, 936-958, 970-974, 990-1063, 1072, 1086-1092, 1105-1113, 1143-1173, 1192-1238, 1257-1292, 1317-1367, 1396-1578, 1600-1648, 1663-1672, 1686-1696, 1711-1723
src\telegram_bot\utils\error_handler.py                        185    159     74      0 10.04%   70-101, 114-123, 138-160, 177-209, 226-255, 276-355, 375-385, 406-420, 444-455, 472-485, 494-506
src\telegram_bot\initialization.py                             123    103     38      0 12.42%   52-88, 103-142, 156-177, 198-223, 234-244, 257-280, 290-297, 326-353
src\telegram_bot\utils\api_client.py                            46     37      8      0 16.67%   27-52, 69-94, 108-127
src\telegram_bot\enhanced_bot.py                                59     44      6      0 23.08%   41-44, 51-69, 73-83, 87-96, 100-118, 126-142
src\utils\config.py                                            159    105     58      0 24.88%   100-115, 119-161, 166-205, 209-291
src\utils\rate_limiter.py                                      120     83     50      5 25.88%   77-118, 128-186, 198-211, 221, 233-242, 263-291, 300-301, 315, 321, 335-336, 351-356
src\telegram_bot\user_profiles.py                              209    139     74      7 27.92%   62->65, 69, 98-109, 124-130, 142-152, 157-159, 171->175, 173, 179, 183-185, 195-227, 239-243, 252, 277-294, 305-315, 328-333, 346-352, 365-378, 387, 398-406, 435-441, 454-460, 475-499, 512-513, 524-533, 548-575
src\dmarket\dmarket_api.py                                     724    421    234     54 39.35%   152-155, 184-185, 194, 198-203, 208-209, 232, 242, 249, 257-258, 261-264, 268-269, 274-276, 297-301, 320-338, 362, 392-396, 413, 425, 461, 477, 490-491, 508, 517-526, 559->563, 571->582, 583, 599->742, 604-612, 620-622, 661-662, 666, 678, 688-711, 715-730, 751, 760-761, 771-780, 806-807, 828-866, 872-874, 890->913, 898->890, 907-910, 914-931, 945-973, 993->1205, 1005-1038, 1042-1059, 1068-1088, 1094-1119, 1129-1132, 1137-1140, 1143->1192, 1151-1189, 1198-1202, 1212, 1216, 1234-1249, 1315, 1318, 1321, 1323->1326, 1341->1358, 1346-1353, 1360-1363, 1390-1419, 1439-1465, 1485-1507, 1526-1531, 1553-1578, 1600, 1612, 1645-1651, 1671-1672, 1692-1693, 1712-1713, 1735-1736, 1755, 1777-1782, 1822-1839, 1864-1870, 1898-1899, 1920-1924, 1960-1973, 1998-2007, 2030-2038, 2063-2070, 2095-2102, 2121-2125, 2148-2156, 2175-2179, 2204-2211, 2242-2244, 2269-2274, 2293-2295, 2317-2322, 2343-2354, 2389, 2397, 2400-2402, 2405, 2409-2411, 2424-2432, 2454-2515, 2529-2540
src\utils\database.py                                          158     60     22      0 54.44%   45-47, 55-57, 179-184, 189-195, 200-213, 218-220, 225-230, 234, 238, 242-251, 255-258, 270-347, 371-395, 409-437
src\dmarket\__init__.py                                         11      4      0      0 63.64%   36-97
--------------------------------------------------------------------------------------------------------
TOTAL                                                        12282  11585   4164     66  4.79%

5 files skipped due to complete coverage.
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
FAIL Required test coverage of 25% not reached. Total coverage: 4.79%
============================= 10 passed in 11.04s =============================
