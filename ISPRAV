# üìä ISPRAV - –û—Ç—á–µ—Ç –æ–± –æ—Ç–ª–∞–¥–∫–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

**–î–∞—Ç–∞**: 2026-01-08
**–í–µ—Ä—Å–∏—è Python**: 3.12.3
**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

---

## üìà –°–í–û–î–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---------|----------|--------|
| **–¢–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ** | 4911 | üü¢ |
| **–¢–µ—Å—Ç–æ–≤ –ø—Ä–æ–≤–∞–ª–µ–Ω–æ** | 26 | üî¥ |
| **–¢–µ—Å—Ç–æ–≤ –ø—Ä–æ–ø—É—â–µ–Ω–æ** | 22 | ‚ö†Ô∏è |
| **Ruff –æ—à–∏–±–æ–∫** | 577 | üü† |

---

## üî¥ P0 - –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ)

### 1. test_notifier.py - 17 –ø—Ä–æ–≤–∞–ª–æ–≤

**–§–∞–π–ª**: `tests/telegram_bot/test_notifier.py`

**–ü—Ä–æ–±–ª–µ–º–∞**: –¢–µ—Å—Ç—ã –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π notifier.
API —Ñ—É–Ω–∫—Ü–∏–π –∏–∑–º–µ–Ω–∏–ª—Å—è, –Ω–æ —Ç–µ—Å—Ç—ã –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã.

**–ü—Ä–æ–≤–∞–ª–∏–≤—à–∏–µ—Å—è —Ç–µ—Å—Ç—ã**:
- `test_load_user_alerts_file_exists`
- `test_load_user_alerts_file_not_exists`
- `test_add_price_alert_new_user`
- `test_add_price_alert_existing_user`
- `test_remove_price_alert_success`
- `test_get_user_alerts_existing_user`
- `test_get_user_alerts_multiple`
- `test_update_user_settings_new_user`
- `test_update_user_settings_existing_user`
- `test_update_user_settings_partial`
- `test_add_multiple_alerts_same_user`
- `test_remove_alert_with_multiple_alerts`
- `test_load_user_alerts_json_error`
- `test_check_all_alerts_resets_daily_counter`
- `test_check_all_alerts_sends_notification`
- `test_check_all_alerts_increments_notification_counter`
- `test_check_all_alerts_deactivates_one_time_alert`

**–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç–µ–∫—É—â–µ–º—É API notifier

---

### 2. test_initialization.py - 3 –ø—Ä–æ–≤–∞–ª–∞

**–§–∞–π–ª**: `tests/telegram_bot/test_initialization.py`

**–ü—Ä–æ–±–ª–µ–º—ã**:
1. `test_setup_logging_custom_level` - –Ω–µ–≤–µ—Ä–Ω—ã–π mock
2. `test_initialize_bot_with_persistence` - PicklePersistence –Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è
3. `test_setup_bot_commands_includes_standard_commands` - –∫–æ–º–∞–Ω–¥—ã –∏–∑–º–µ–Ω–∏–ª–∏—Å—å (—Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ start, help, settings)

**–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –ø–æ–¥ —Ç–µ–∫—É—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é

---

### 3. test_telegram_bot_modules.py - 2 –ø—Ä–æ–≤–∞–ª–∞

**–§–∞–π–ª**: `tests/telegram_bot/test_telegram_bot_modules.py`

**–ü—Ä–æ–±–ª–µ–º–∞**: `sales_analysis_callbacks` –Ω–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ `src.telegram_bot`

**–†–µ—à–µ–Ω–∏–µ**: –õ–∏–±–æ –¥–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç, –ª–∏–±–æ —É–¥–∞–ª–∏—Ç—å —Ç–µ—Å—Ç—ã

---

## üü† P1 - –í–ê–ñ–ù–´–ï (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è)

### 4. test_dmarket_api_phase4_part1.py - 2 –ø—Ä–æ–≤–∞–ª–∞

**–§–∞–π–ª**: `tests/dmarket/test_dmarket_api_phase4_part1.py`

**–ü—Ä–æ–±–ª–µ–º—ã**:
- `test_save_to_cache_with_different_ttl` - –∫—ç—à –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç
- `test_cache_cleanup_on_overflow` - –Ω–µ–≤–µ—Ä–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ cleanup

---

### 5. test_adaptive_polling.py - 1 –ø—Ä–æ–≤–∞–ª

**–§–∞–π–ª**: `tests/dmarket/test_adaptive_polling.py`

**–ü—Ä–æ–±–ª–µ–º–∞**: `test_force_poll_detects_changes` - mock –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

### 6. test_smart_notifier.py - 1 –ø—Ä–æ–≤–∞–ª

**–§–∞–π–ª**: `tests/telegram_bot/test_smart_notifier.py`

**–ü—Ä–æ–±–ª–µ–º–∞**: `test_deprecation_warning_on_import` - warning –Ω–µ –≤—ã–¥–∞—ë—Ç—Å—è

---

## üü° P2 - –ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (Ruff warnings)

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ Ruff (577 –æ—à–∏–±–æ–∫):

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö–æ–ª-–≤–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|--------|----------|
| PLC2701 | 97 | Import private name from external module |
| PT023 | 96 | pytest-incorrect-mark-parentheses-style |
| PLC1901 | 51 | compare-to-empty-string |
| DTZ001 | 39 | datetime without tzinfo |
| PT001 | 34 | pytest-fixture-incorrect-parentheses-style |
| I001 | 29 | unsorted-imports |
| F401 | 23 | unused-import |
| PLR0904 | 12 | too-many-public-methods |
| PLR1702 | 9 | too-many-nested-blocks |
| S104 | 6 | hardcoded-bind-all-interfaces |
| S301/S403 | 4 | pickle security warnings |

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:

1. `src/dmarket/dmarket_api.py` - 50 public methods (PLR0904)
2. `src/dmarket/adaptive_polling.py` - deep nesting (PLR1702)
3. `src/dmarket/backtester.py` - deep nesting (PLR1702)
4. `src/dmarket/intramarket_arbitrage.py` - deep nesting (PLR1702)
5. `src/telegram_bot/health_check.py` - binding to all interfaces (S104)
6. `src/ml/enhanced_predictor.py` - pickle security (S301)

---

## üìã –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (P0):
1. [ ] –û–±–Ω–æ–≤–∏—Ç—å `tests/telegram_bot/test_notifier.py` - 17 —Ç–µ—Å—Ç–æ–≤
2. [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å `tests/telegram_bot/test_initialization.py` - 3 —Ç–µ—Å—Ç–∞
3. [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å `tests/telegram_bot/test_telegram_bot_modules.py` - 2 —Ç–µ—Å—Ç–∞

### –í –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è (P1):
4. [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å `tests/dmarket/test_dmarket_api_phase4_part1.py` - 2 —Ç–µ—Å—Ç–∞
5. [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å `tests/dmarket/test_adaptive_polling.py` - 1 —Ç–µ—Å—Ç
6. [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å `tests/telegram_bot/test_smart_notifier.py` - 1 —Ç–µ—Å—Ç

### –ü–æ–∑–∂–µ (P2):
7. [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å 190 auto-fixable Ruff –æ—à–∏–±–æ–∫
8. [ ] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ deep nesting –≤ 5 —Ñ–∞–π–ª–∞—Ö
9. [ ] Security fixes –¥–ª—è pickle –∏ bind-all-interfaces

---

*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: 2026-01-08*
