# üîê –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–î–∞—Ç–∞**: 17 –¥–µ–∫–∞–±—Ä—è 2025 –≥.
**–í–µ—Ä—Å–∏—è**: 3.0
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ü–æ–ª–Ω–∞—è –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#–æ–±—â–∏–µ-–ø—Ä–∏–Ω—Ü–∏–ø—ã-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- [üö® –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–µ–Ω—å–≥–∞—Ö](#–±–µ–∑–æ–ø–∞—Å–Ω–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-–Ω–∞-—Ä–µ–∞–ª—å–Ω—ã—Ö-–¥–µ–Ω—å–≥–∞—Ö)
- [–ó–∞—â–∏—Ç–∞ API –∫–ª—é—á–µ–π](#–∑–∞—â–∏—Ç–∞-api-–∫–ª—é—á–µ–π)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Telegram –±–æ—Ç–∞](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å-telegram-–±–æ—Ç–∞)
- [–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫-–∏-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏](#–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏)

---

## üö® –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–µ–Ω—å–≥–∞—Ö

### ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –†–µ–∂–∏–º DRY_RUN

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **–±–µ–∑–æ–ø–∞—Å–Ω–æ–º —Ä–µ–∂–∏–º–µ** (`DRY_RUN=true`), –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º:
- ‚úÖ **–ù–ï** —Å–æ–≤–µ—Ä—à–∞—é—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ —Å–¥–µ–ª–∫–∏
- ‚úÖ –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–∫—É–ø–∫–∏/–ø—Ä–æ–¥–∞–∂–∏ **—Å–∏–º—É–ª–∏—Ä—É—é—Ç—Å—è**
- ‚úÖ –í–∞—à –±–∞–ª–∞–Ω—Å –Ω–∞ DMarket **–æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º**
- ‚úÖ –õ–æ–≥–∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è `[DRY-RUN]`

**–ù–ò–ö–û–ì–î–ê** –Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–π—Ç–µ—Å—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é —Ç–æ—Ä–≥–æ–≤–ª—é (`DRY_RUN=false`) –±–µ–∑ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!

### üìã –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–µ–Ω—å–≥–∞—Ö

#### –®–∞–≥ 1: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ DRY_RUN —Ä–µ–∂–∏–º–µ (48-72 —á–∞—Å–∞ –º–∏–Ω–∏–º—É–º)

- [ ] ‚úÖ –ë–æ—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –º–∏–Ω–∏–º—É–º **48-72 —á–∞—Å–∞** –≤ `DRY_RUN=true`
- [ ] ‚úÖ –í—Å–µ –ª–æ–≥–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- [ ] ‚úÖ –ê—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–π —Å–∫–∞–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- [ ] ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ç–∞—Ä–≥–µ—Ç–æ–≤ —Å–æ–∑–¥–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–∞—è–≤–∫–∏ (–≤ DRY_RUN)
- [ ] ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ
- [ ] ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] ‚úÖ –ù–µ—Ç —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏ (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ `htop`/`Task Manager`)
- [ ] ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ Sentry –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

#### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤

–ü–µ—Ä–µ–¥ –≤–∫–ª—é—á–µ–Ω–∏–µ–º —Ä–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞—â–∏—Ç–Ω—ã–µ –ª–∏–º–∏—Ç—ã:

```env
# .env —Ñ–∞–π–ª - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏
DRY_RUN=false  # –û–ü–ê–°–ù–û! –†–µ–∞–ª—å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è!

# –ó–∞—â–∏—Ç–Ω—ã–µ –ª–∏–º–∏—Ç—ã
MAX_TRADE_VALUE=50.00          # –ú–∞–∫—Å $50 –Ω–∞ –æ–¥–Ω—É —Å–¥–µ–ª–∫—É
DAILY_TRADE_LIMIT=500.00       # –ú–∞–∫—Å $500 –≤ –¥–µ–Ω—å
MIN_PROFIT_PERCENT=5.0         # –ú–∏–Ω 5% –ø—Ä–∏–±—ã–ª–∏
MAX_CONCURRENT_TRADES=3        # –ú–∞–∫—Å 3 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–¥–µ–ª–∫–∏

# –°—Ç–æ–ø-–ª–æ—Å—Å –∑–∞—â–∏—Ç–∞
STOP_LOSS_PERCENT=10.0         # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ—Å–ª–∏ —Ü–µ–Ω–∞ —É–ø–∞–ª–∞ –Ω–∞ 10%
MAX_CONSECUTIVE_LOSSES=5       # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Å–ª–µ 5 —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ –ø–æ–¥—Ä—è–¥

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–∞–ª–∞–Ω—Å–∞
MIN_BALANCE_THRESHOLD=10.00    # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ—Å–ª–∏ –±–∞–ª–∞–Ω—Å < $10
BALANCE_CHECK_INTERVAL=300     # –ü—Ä–æ–≤–µ—Ä—è—Ç—å –±–∞–ª–∞–Ω—Å –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
```

- [ ] ‚úÖ `MAX_TRADE_VALUE` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- [ ] ‚úÖ `DAILY_TRADE_LIMIT` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] ‚úÖ `MIN_PROFIT_PERCENT` –Ω–µ –º–µ–Ω–µ–µ 3-5%
- [ ] ‚úÖ `STOP_LOSS_PERCENT` –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] ‚úÖ `MIN_BALANCE_THRESHOLD` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

#### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

- [ ] ‚úÖ **Sentry** –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
- [ ] ‚úÖ **Email/Telegram –∞–ª–µ—Ä—Ç—ã** –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è:
  - –ë–∞–ª–∞–Ω—Å –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–∞
  - –°–µ—Ä–∏—è —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫
  - –û—à–∏–±–∫–∏ API DMarket
  - –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –¥–Ω–µ–≤–Ω–æ–≥–æ –ª–∏–º–∏—Ç–∞
- [ ] ‚úÖ **–õ–æ–≥–∏** —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å —Ä–æ—Ç–∞—Ü–∏–µ–π (–Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω—è—é—Ç –¥–∏—Å–∫)
- [ ] ‚úÖ **Dashboard** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### –®–∞–≥ 4: –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ)
- [ ] ‚úÖ –ë—ç–∫–∞–ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `.env` (–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ)
- [ ] ‚úÖ –ë—ç–∫–∞–ø –ª–æ–≥–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏
- [ ] ‚úÖ –ü–ª–∞–Ω –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ —Å–±–æ–µ

#### –®–∞–≥ 5: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

- [ ] ‚úÖ **–ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –∑–∞–ø–∏—Å–∞–Ω** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- [ ] ‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç** (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ)
- [ ] ‚úÖ **–î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É** –µ—Å—Ç—å –¥–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- [ ] ‚úÖ **–í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞** –∑–∞–ø–∏—Å–∞–Ω–æ
- [ ] ‚úÖ –ü—Ä–æ—á–∏—Ç–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è [DEBUG_WORKFLOW.md](DEBUG_WORKFLOW.md)

### üõë –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ** –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

#### –ú–µ—Ç–æ–¥ 1: –ß–µ—Ä–µ–∑ Telegram (—Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π)

```
/stop_trading        # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–¥–µ–ª–∫–∏
/cancel_all_targets  # –û—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ —Ç–∞—Ä–≥–µ—Ç—ã
/withdraw_balance    # –í—ã–≤–µ—Å—Ç–∏ –±–∞–ª–∞–Ω—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

#### –ú–µ—Ç–æ–¥ 2: –ß–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç)

```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh user@your-server.com

# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å –±–æ—Ç–∞
ps aux | grep python

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
kill -TERM <PID>  # Graceful shutdown
# –∏–ª–∏
kill -KILL <PID>  # Force kill (–∫—Ä–∞–π–Ω–∏–π —Å–ª—É—á–∞–π)

# –î–ª—è Docker
docker stop dmarket-bot
```

#### –ú–µ—Ç–æ–¥ 3: –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å DRY_RUN –æ–±—Ä–∞—Ç–Ω–æ

```bash
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env
nano .env

# –ò–∑–º–µ–Ω–∏—Ç—å
DRY_RUN=true  # –í–µ—Ä–Ω—É—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
docker-compose restart bot
# –∏–ª–∏
systemctl restart dmarket-bot
```

### üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ

#### –£—Ç—Ä–µ–Ω–Ω–∏–π —á–µ–∫-–ª–∏—Å—Ç (5 –º–∏–Ω—É—Ç)

- [ ] –ë–∞–ª–∞–Ω—Å –Ω–∞ DMarket —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É
- [ ] –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ Sentry
- [ ] –ë–æ—Ç –∞–∫—Ç–∏–≤–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã
- [ ] –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–¥–µ–ª–∫–∏ –±—ã–ª–∏ –ø—Ä–∏–±—ã–ª—å–Ω—ã–º–∏
- [ ] –õ–æ–≥–∏ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–æ–±–ª–µ–º —Å API

#### –í–µ—á–µ—Ä–Ω–∏–π —á–µ–∫-–ª–∏—Å—Ç (10 –º–∏–Ω—É—Ç)

- [ ] –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Å–¥–µ–ª–∫–∏ –∑–∞ –¥–µ–Ω—å
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—â—É—é –ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫
- [ ] –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É–±—ã—Ç–æ—á–Ω—ã–µ —Å–¥–µ–ª–∫–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

#### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç (30 –º–∏–Ω—É—Ç)

- [ ] –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –≤—Å–µ—Ö —Å–¥–µ–ª–æ–∫
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–µ—Å–ª–∏ –µ—Å—Ç—å –ø–∞—Ç—á–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- [ ] –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤
- [ ] –ë—ç–∫–∞–ø –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

### ‚ö° –ö—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏ - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ—Ä–≥–æ–≤–ª—é!

–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞ **–ù–ï–ú–ï–î–õ–ï–ù–ù–û** –µ—Å–ª–∏:

1. üö® **–ë–∞–ª–∞–Ω—Å —Ä–µ–∑–∫–æ —É–ø–∞–ª** (–±–æ–ª–µ–µ 10% –∑–∞ —á–∞—Å)
2. üö® **5+ —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ –ø–æ–¥—Ä—è–¥**
3. üö® **API DMarket –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏** (429, 500, 503)
4. üö® **–ù–µ–æ–±—ã—á–Ω–æ –≤—ã—Å–æ–∫–∏–µ —Ü–µ–Ω—ã** (–≤–æ–∑–º–æ–∂–Ω—ã–π –±–∞–≥ —Å–∫—Ä–µ–π–ø–∏–Ω–≥–∞)
5. üö® **–ë–æ—Ç –ø–æ–∫—É–ø–∞–µ—Ç –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –ø—Ä–µ–¥–º–µ—Ç—ã** (–∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ)
6. üö® **–ù–µ—Ç –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ 24+ —á–∞—Å–∞**
7. üö® **Sentry –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏**
8. üö® **–î–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω —Ä–∞–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏**

### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏

#### –ù–∞—á–∏–Ω–∞–π—Ç–µ —Å –º–∞–ª–æ–≥–æ

```
–î–µ–Ω—å 1-3:   MAX_TRADE_VALUE=$10,  DAILY_LIMIT=$50
–î–µ–Ω—å 4-7:   MAX_TRADE_VALUE=$25,  DAILY_LIMIT=$150
–î–µ–Ω—å 8-14:  MAX_TRADE_VALUE=$50,  DAILY_LIMIT=$300
–î–µ–Ω—å 15+:   –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```

#### –î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

- ‚úÖ –¢–æ—Ä–≥—É–π—Ç–µ **—Ä–∞–∑–Ω—ã–º–∏ –∏–≥—Ä–∞–º–∏** (CS:GO, Dota 2, TF2)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **—Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏** (boost, standard, medium)
- ‚úÖ –ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ **—Ç–∞—Ä–≥–µ—Ç—ã + –ø—Ä—è–º—ã–µ –ø–æ–∫—É–ø–∫–∏**
- ‚úÖ –ù–µ –¥–µ—Ä–∂–∏—Ç–µ –≤—Å–µ —è–π—Ü–∞ –≤ –æ–¥–Ω–æ–π –∫–æ—Ä–∑–∏–Ω–µ

#### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–∞ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü

```
–ù–µ–¥–µ–ª—è 1: –¢–æ–ª—å–∫–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ (DRY_RUN=true)
–ù–µ–¥–µ–ª—è 2: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã, –∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ù–µ–¥–µ–ª—è 3: –£–º–µ—Ä–µ–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã, –µ—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ
–ù–µ–¥–µ–ª—è 4: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ ROI
```

#### –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

- üîÑ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–æ—Ç–∞ **–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ**
- üîÑ –û–±–Ω–æ–≤–ª—è–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ**
- üîÑ –ß–∏—Ç–∞–π—Ç–µ [CHANGELOG.md](../CHANGELOG.md) –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- üîÑ –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ DRY_RUN **24 —á–∞—Å–∞** –ø–µ—Ä–µ–¥ production

### üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –ø–æ–º–æ—â—å

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏**: `logs/dmarket_bot.log`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Sentry**: –û—à–∏–±–∫–∏ –∏ —Ç—Ä–µ–π—Å—ã
3. **–°–æ–∑–¥–∞–π—Ç–µ Issue**: [GitHub Issues](https://github.com/your-repo/issues)
4. **–≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–º–æ—â—å**: `support@your-domain.com`

**–ü–û–ú–ù–ò–¢–ï**: –õ—É—á—à–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ—Ä–≥–æ–≤–ª—é –∏ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, —á–µ–º –ø–æ—Ç–µ—Ä—è—Ç—å –¥–µ–Ω—å–≥–∏!

---

## üõ°Ô∏è –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ü—Ä–∏–Ω—Ü–∏–ø –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ production
- –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∏ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### –ó–∞—â–∏—Ç–∞ –≤ –≥–ª—É–±–∏–Ω—É

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∑–∞—â–∏—Ç—É
- –ù–µ –ø–æ–ª–∞–≥–∞–π—Ç–µ—Å—å –Ω–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö

---

## üîë –ó–∞—â–∏—Ç–∞ API –∫–ª—é—á–µ–π

### –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤

**‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:**

```python
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
import os
from dotenv import load_dotenv

load_dotenv()

DMARKET_PUBLIC_KEY = os.getenv("DMARKET_PUBLIC_KEY")
DMARKET_SECRET_KEY = os.getenv("DMARKET_SECRET_KEY")
TELEGRAM_BOT_TOKEN = os.getenv("TELEGRAM_BOT_TOKEN")
```

**‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**

```python
# –ù–ï —Ö—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–¥–µ!
DMARKET_PUBLIC_KEY = "abc123def456"
DMARKET_SECRET_KEY = "secret_key_here"
```

### –§–∞–π–ª .env

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# DMarket API
DMARKET_PUBLIC_KEY=your_public_key_here
DMARKET_SECRET_KEY=your_secret_key_here

# Telegram
TELEGRAM_BOT_TOKEN=your_bot_token_here

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DATABASE_URL=postgresql://user:password@localhost/dmarket_bot

# Redis
REDIS_URL=redis://localhost:6379/0
```

**–í–∞–∂–Ω–æ:** –î–æ–±–∞–≤—å—Ç–µ `.env` –≤ `.gitignore`:

```gitignore
# Environment variables
.env
.env.local
.env.*.local
```

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ API –∫–ª—é—á–µ–π –≤ –ë–î

–î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö API –∫–ª—é—á–µ–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:

```python
from cryptography.fernet import Fernet
import base64
import os

class EncryptionManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è API –∫–ª—é—á–µ–π."""

    def __init__(self):
        # –ü–æ–ª—É—á–∏—Ç—å –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
        encryption_key = os.getenv("ENCRYPTION_KEY")
        if not encryption_key:
            raise ValueError("ENCRYPTION_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")

        self.cipher = Fernet(encryption_key.encode())

    def encrypt_api_key(self, api_key: str) -> str:
        """–ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å API –∫–ª—é—á."""
        encrypted = self.cipher.encrypt(api_key.encode())
        return base64.b64encode(encrypted).decode()

    def decrypt_api_key(self, encrypted_key: str) -> str:
        """–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å API –∫–ª—é—á."""
        encrypted = base64.b64decode(encrypted_key.encode())
        return self.cipher.decrypt(encrypted).decode()
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

```python
from cryptography.fernet import Fernet

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á (—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!)
key = Fernet.generate_key()
print(f"ENCRYPTION_KEY={key.decode()}")
```

---

## üóÑÔ∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ (SQLAlchemy):**

```python
from sqlalchemy import select

async def get_user(user_id: int):
    stmt = select(User).where(User.telegram_id == user_id)
    result = await session.execute(stmt)
    return result.scalar_one_or_none()
```

**‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (SQL –∏–Ω—ä–µ–∫—Ü–∏—è):**

```python
# –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫ –¥–ª—è SQL!
query = f"SELECT * FROM users WHERE telegram_id = {user_id}"
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

```python
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSL –¥–ª—è production
DATABASE_URL = "postgresql://user:password@localhost/db?sslmode=require"
```

### –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã

```bash
#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–∞–ø–∞ –ë–î

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backups"

# PostgreSQL –±—ç–∫–∞–ø
pg_dump dmarket_bot_prod > "$BACKUP_DIR/dmarket_bot_$DATE.sql"

# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞
gpg --encrypt --recipient admin@example.com "$BACKUP_DIR/dmarket_bot_$DATE.sql"

# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞
rm "$BACKUP_DIR/dmarket_bot_$DATE.sql"

# –•—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π
find $BACKUP_DIR -name "*.sql.gpg" -mtime +30 -delete
```

---

## ü§ñ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Telegram –±–æ—Ç–∞

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞

```python
from telegram import Update
from telegram.ext import ContextTypes

# –°–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
ALLOWED_USERS = [123456789, 987654321]

async def restricted(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞."""
    user_id = update.effective_user.id

    if user_id not in ALLOWED_USERS:
        await update.message.reply_text("‚ùå –£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É –±–æ—Ç—É")
        return False

    return True

async def admin_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–ö–æ–º–∞–Ω–¥–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤."""
    if not await restricted(update, context):
        return

    # –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É
    await update.message.reply_text("‚úÖ –ö–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞")
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```python
import re

async def create_target_handler(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞—Ä–≥–µ—Ç–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π."""

    # –ü–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—É –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    price_input = context.args[0] if context.args else None

    if not price_input:
        await update.message.reply_text("‚ùå –£–∫–∞–∂–∏—Ç–µ —Ü–µ–Ω—É")
        return

    # –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–Ω—ã
    if not re.match(r'^\d+\.?\d{0,2}$', price_input):
        await update.message.reply_text("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ü–µ–Ω—ã. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: 10.50")
        return

    price = float(price_input)

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
    if not 0.01 <= price <= 10000:
        await update.message.reply_text("‚ùå –¶–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç $0.01 –¥–æ $10,000")
        return

    # –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞—Ä–≥–µ—Ç–∞
    # ...
```

### Rate Limiting –¥–ª—è –∫–æ–º–∞–Ω–¥

```python
from datetime import datetime, timedelta
from collections import defaultdict

class CommandRateLimiter:
    """Rate limiter –¥–ª—è –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞."""

    def __init__(self, max_calls: int = 10, time_window: int = 60):
        self.max_calls = max_calls
        self.time_window = time_window  # —Å–µ–∫—É–Ω–¥
        self.calls = defaultdict(list)

    async def is_allowed(self, user_id: int) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–∞–∑—Ä–µ—à–µ–Ω –ª–∏ –∑–∞–ø—Ä–æ—Å."""
        now = datetime.now()
        cutoff = now - timedelta(seconds=self.time_window)

        # –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏
        self.calls[user_id] = [
            t for t in self.calls[user_id] if t > cutoff
        ]

        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç
        if len(self.calls[user_id]) >= self.max_calls:
            return False

        # –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –≤—ã–∑–æ–≤
        self.calls[user_id].append(now)
        return True

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
rate_limiter = CommandRateLimiter(max_calls=5, time_window=60)

async def scanner_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id

    if not await rate_limiter.is_allowed(user_id):
        await update.message.reply_text(
            "‚è±Ô∏è –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –º–∏–Ω—É—Ç—É."
        )
        return

    # –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É
    # ...
```

---

## üìù –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:**

```python
import structlog

logger = structlog.get_logger(__name__)

async def process_payment(user_id: int, amount: float):
    logger.info(
        "processing_payment",
        user_id=user_id,
        amount=amount
    )
    # –ù–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ!
```

**‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**

```python
# –ù–ï –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å API –∫–ª—é—á–∏, –ø–∞—Ä–æ–ª–∏, —Ç–æ–∫–µ–Ω—ã!
logger.info(f"API key: {api_key}")  # –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!
logger.info(f"Password: {password}")  # –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!
```

### –ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```python
def mask_api_key(api_key: str) -> str:
    """–ú–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å API –∫–ª—é—á –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è."""
    if len(api_key) <= 8:
        return "***"
    return f"{api_key[:4]}***{api_key[-4:]}"

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
logger.info(f"Using API key: {mask_api_key(api_key)}")
# Output: "Using API key: abcd***xyz9"
```

---

## üéØ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
pip-audit

# –û–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install --upgrade -r requirements.txt

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å Safety
safety check
```

### 2. HTTPS –¥–ª—è –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

```python
# –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
DMARKET_API_URL = "https://api.dmarket.com"  # ‚úÖ
# –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTP:
# DMARKET_API_URL = "http://api.dmarket.com"  # ‚ùå
```

### 3. –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA)

–í–∫–ª—é—á–∏—Ç–µ 2FA –¥–ª—è –≤—Å–µ—Ö –≤–∞–∂–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:
- GitHub
- DMarket –∞–∫–∫–∞—É–Ω—Ç
- –•–æ—Å—Ç–∏–Ω–≥ –ø—Ä–æ–≤–∞–π–¥–µ—Ä
- Email

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```python
# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Sentry –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
import sentry_sdk

sentry_sdk.init(
    dsn=os.getenv("SENTRY_DSN"),
    traces_sample_rate=1.0,
    send_default_pii=False  # –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
)
```

### 5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Docker

```dockerfile
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ non-root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
FROM python:3.11-slim

# –°–æ–∑–¥–∞—Ç—å –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
RUN useradd -m -u 1000 botuser

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
USER botuser

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
COPY --chown=botuser:botuser . .

CMD ["python", "-m", "src.main"]
```

### 6. –°–µ–∫—Ä–µ—Ç—ã –≤ Docker

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker secrets –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# –°–æ–∑–¥–∞—Ç—å secret
echo "my_secret_key" | docker secret create dmarket_secret_key -

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ docker-compose.yml
version: '3.8'
services:
  bot:
    image: dmarket-bot
    secrets:
      - dmarket_secret_key

secrets:
  dmarket_secret_key:
    external: true
```

---

## üö® –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ —É—Ç–µ—á–∫–µ —Å–µ–∫—Ä–µ—Ç–æ–≤

### 1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

1. **–û—Ç–∑–æ–≤–∏—Ç–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏** –≤ –ø–∞–Ω–µ–ª–∏ DMarket
2. **–°–º–µ–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞** —á–µ—Ä–µ–∑ @BotFather
3. **–û–±–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä–æ–ª–∏** –∫–æ –≤—Å–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### 2. –û—á–∏—Å—Ç–∫–∞ Git –∏—Å—Ç–æ—Ä–∏–∏

```bash
# –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª –∏–∑ –≤—Å–µ–π –∏—Å—Ç–æ—Ä–∏–∏ Git
git filter-branch --force --index-filter \
  "git rm --cached --ignore-unmatch .env" \
  --prune-empty --tag-name-filter cat -- --all

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π push
git push origin --force --all
git push origin --force --tags
```

### 3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

- –£–≤–µ–¥–æ–º–∏—Ç–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –≤–æ–∑–º–æ–∂–Ω–æ–π —É—Ç–µ—á–∫–µ
- –ó–∞–ø—Ä–æ—Å–∏—Ç–µ —Å–º–µ–Ω—É –ø–∞—Ä–æ–ª–µ–π
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–∏—á–∏–Ω—É —É—Ç–µ—á–∫–∏

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Python Security Best Practices](https://python.readthedocs.io/en/stable/library/security_warnings.html)
- [Telegram Bot Security Guide](https://core.telegram.org/bots/security)
- [DMarket API Security](https://docs.dmarket.com/docs/security)

---

**–ü–æ–º–Ω–∏—Ç–µ:** –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å - —ç—Ç–æ –Ω–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è –∑–∞–¥–∞—á–∞, –∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å!
