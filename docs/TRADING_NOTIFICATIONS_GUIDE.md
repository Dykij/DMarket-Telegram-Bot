# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–æ—Ä–≥–æ–≤—ã–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º

**–î–∞—Ç–∞**: 19 –Ω–æ—è–±—Ä—è 2025 –≥.
**–í–µ—Ä—Å–∏—è**: 1.0

---

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —Ç–æ—Ä–≥–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Telegram –±–æ—Ç–∞ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä—É—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–∞–º–µ—Ä–µ–Ω–∏–∏ –ø–æ–∫—É–ø–∫–∏** - –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –ø–æ–∫—É–ø–∫–æ–π —Å –¥–µ—Ç–∞–ª—è–º–∏ –æ —Ü–µ–Ω–µ –∏ –ø—Ä–∏–±—ã–ª–∏
- ‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω–æ–π –ø–æ–∫—É–ø–∫–µ** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å –Ω–æ–º–µ—Ä–æ–º –∑–∞–∫–∞–∑–∞
- ‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –ø–æ–∫—É–ø–∫–∏** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏—á–∏–Ω–µ –Ω–µ—É–¥–∞—á–∏
- ‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–¥–∞–∂–µ** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å —Ä–∞—Å—á–µ—Ç–æ–º –ø—Ä–∏–±—ã–ª–∏
- ‚úÖ **–ö–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–∫—É–ø–∫—É –¥–æ –µ—ë –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚úÖ **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä DRY-RUN** - —á–µ—Ç–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞

---

## üéØ –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### 1. Buy Intent Notification (–ù–∞–º–µ—Ä–µ–Ω–∏–µ –∫—É–ø–∏—Ç—å)

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è **–ø–µ—Ä–µ–¥** –ø–æ–∫—É–ø–∫–æ–π –ø—Ä–µ–¥–º–µ—Ç–∞ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–º–µ–Ω—ã.

**–ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è:**
```
üõí –ù–ê–ú–ï–†–ï–ù–ò–ï –ö–£–ü–ò–¢–¨ [DRY-RUN]

üì¶ –ü—Ä–µ–¥–º–µ—Ç: AK-47 | Redline (Field-Tested)
üíµ –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏: $8.50
üí∞ –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏: $9.20
üìà –ü—Ä–∏–±—ã–ª—å: $0.52 (6.1%)
üîç –ò—Å—Ç–æ—á–Ω–∏–∫: arbitrage_scanner

[–û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–∫—É–ø–∫—É] <- inline –∫–Ω–æ–ø–∫–∞
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```python
await send_buy_intent_notification(
    bot=bot,
    user_id=123456789,
    item_name="AK-47 | Redline (Field-Tested)",
    buy_price=8.50,
    sell_price=9.20,
    profit_usd=0.52,
    profit_percent=6.1,
    source="arbitrage_scanner",
    dry_run=True,
    notification_queue=queue,
    item_id="item_12345"
)
```

### 2. Buy Success Notification (–£—Å–ø–µ—à–Ω–∞—è –ø–æ–∫—É–ø–∫–∞)

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è **–ø–æ—Å–ª–µ** —É—Å–ø–µ—à–Ω–æ–π –ø–æ–∫—É–ø–∫–∏ –ø—Ä–µ–¥–º–µ—Ç–∞.

**–ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è:**
```
‚úÖ –ü–û–ö–£–ü–ö–ê –í–´–ü–û–õ–ù–ï–ù–ê [DRY-RUN]

üì¶ –ü—Ä–µ–¥–º–µ—Ç: AK-47 | Redline (Field-Tested)
üíµ –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏: $8.50
üí∞ –í—ã—Å—Ç–∞–≤–ª–µ–Ω–æ –Ω–∞ –ø—Ä–æ–¥–∞–∂—É: $9.20
üìã Order ID: order_67890

[–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ DMarket] <- inline –∫–Ω–æ–ø–∫–∞
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```python
await send_buy_success_notification(
    bot=bot,
    user_id=123456789,
    item_name="AK-47 | Redline (Field-Tested)",
    buy_price=8.50,
    sell_price=9.20,
    order_id="order_67890",
    dry_run=True,
    notification_queue=queue
)
```

### 3. Buy Failed Notification (–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏)

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–π –ø–æ–ø—ã—Ç–∫–µ –ø–æ–∫—É–ø–∫–∏.

**–ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è:**
```
‚ùå –û–®–ò–ë–ö–ê –ü–û–ö–£–ü–ö–ò [LIVE]

üì¶ –ü—Ä–µ–¥–º–µ—Ç: AK-47 | Redline (Field-Tested)
üíµ –¶–µ–Ω–∞: $8.50
‚ö†Ô∏è –ü—Ä–∏—á–∏–Ω–∞: Insufficient balance
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```python
await send_buy_failed_notification(
    bot=bot,
    user_id=123456789,
    item_name="AK-47 | Redline (Field-Tested)",
    buy_price=8.50,
    error_reason="Insufficient balance",
    dry_run=False,
    notification_queue=queue
)
```

### 4. Sell Success Notification (–£—Å–ø–µ—à–Ω–∞—è –ø—Ä–æ–¥–∞–∂–∞)

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–¥–∞–∂–∏ –ø—Ä–µ–¥–º–µ—Ç–∞.

**–ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è:**
```
üí∞ –ü–†–û–î–ê–ñ–ê –í–´–ü–û–õ–ù–ï–ù–ê [DRY-RUN]

üì¶ –ü—Ä–µ–¥–º–µ—Ç: AK-47 | Redline (Field-Tested)
üíµ –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏: $8.50
üí∞ –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏: $9.20
üìà –ü—Ä–∏–±—ã–ª—å: $0.52 (6.1%)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```python
await send_sell_success_notification(
    bot=bot,
    user_id=123456789,
    item_name="AK-47 | Redline (Field-Tested)",
    buy_price=8.50,
    sell_price=9.20,
    profit_usd=0.52,
    profit_percent=6.1,
    dry_run=True,
    notification_queue=queue
)
```

---

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TradingNotifier

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from src.utils.trading_notifier import TradingNotifier
from src.dmarket.dmarket_api import DMarketAPI
from telegram import Bot

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
api = DMarketAPI(public_key, secret_key)
bot = Bot(token=bot_token)
notification_queue = NotificationQueue()

# –°–æ–∑–¥–∞–Ω–∏–µ TradingNotifier
trading_notifier = TradingNotifier(
    api_client=api,
    bot=bot,
    notification_queue=notification_queue,
    user_id=123456789
)

# –ü–æ–∫—É–ø–∫–∞ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
result = await trading_notifier.buy_item_with_notifications(
    item_id="item_12345",
    item_name="AK-47 | Redline (Field-Tested)",
    buy_price=8.50,
    sell_price=9.20,
    profit_usd=0.52,
    profit_percent=6.1,
    source="arbitrage_scanner"
)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
if result.get("success"):
    print(f"–ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞! Order ID: {result.get('order_id')}")
else:
    print(f"–û—à–∏–±–∫–∞: {result.get('error')}")
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ArbitrageScanner

```python
from src.dmarket.arbitrage_scanner import ArbitrageScanner
from src.utils.trading_notifier import TradingNotifier

async def scan_and_trade(user_id: int):
    """–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∞—Ä–±–∏—Ç—Ä–∞–∂ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫—É–ø–∞—Ç—å —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏."""

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    scanner = ArbitrageScanner(api_client=api)
    trading_notifier = TradingNotifier(
        api_client=api,
        bot=bot,
        notification_queue=notification_queue,
        user_id=user_id
    )

    # –ù–∞–π—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
    opportunities = await scanner.scan_level(
        level="standard",
        game="csgo"
    )

    # –ö—É–ø–∏—Ç—å –ª—É—á—à–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
    for opp in opportunities[:3]:  # –¢–æ–ø-3
        result = await trading_notifier.buy_item_with_notifications(
            item_id=opp["item_id"],
            item_name=opp["title"],
            buy_price=opp["buy_price"],
            sell_price=opp["sell_price"],
            profit_usd=opp["profit"],
            profit_percent=opp["profit_percent"],
            source="arbitrage_scanner"
        )

        # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–∫—É–ø–∫–∞–º–∏
        await asyncio.sleep(2)
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ helper-—Ñ—É–Ω–∫—Ü–∏–∏

```python
from src.utils.trading_notifier import buy_with_notifications

# –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ø–æ–∫—É–ø–∫–∞ —á–µ—Ä–µ–∑ helper
result = await buy_with_notifications(
    api_client=api,
    bot=bot,
    notification_queue=notification_queue,
    user_id=123456789,
    item_id="item_12345",
    item_name="AK-47 | Redline (Field-Tested)",
    buy_price=8.50,
    sell_price=9.20,
    profit_usd=0.52,
    profit_percent=6.1,
    source="manual_purchase"
)
```

---

## üéÆ Callback-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

### –û—Ç–º–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–∫—É–ø–∫—É", –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `handle_buy_cancel_callback`:

```python
async def handle_buy_cancel_callback(update, context):
    """–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç–º–µ–Ω—É –ø–æ–∫—É–ø–∫–∏."""
    query = update.callback_query
    callback_data = query.data

    if callback_data.startswith("cancel_buy:"):
        item_id = callback_data.split(":", 1)[1]

        # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω—ã
        logger.info(f"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª –ø–æ–∫—É–ø–∫—É –ø—Ä–µ–¥–º–µ—Ç–∞ {item_id}")

        # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        await query.answer("–ü–æ–∫—É–ø–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞")
        await query.edit_message_text(
            text=query.message.text + "\n\n‚ùå *–û–¢–ú–ï–ù–ï–ù–û –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ú*",
            parse_mode="Markdown"
        )
```

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `register_notification_handlers`:

```python
from src.telegram_bot.notifier import register_notification_handlers

# –í main.py
application = Application.builder().token(token).build()
await register_notification_handlers(application)
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### DRY-RUN —Ä–µ–∂–∏–º

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **DRY-RUN** —Ä–µ–∂–∏–º–µ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

```python
# –í .env
DRY_RUN=true  # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
# DRY_RUN=false  # –†–µ–∞–ª—å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è (–û–ü–ê–°–ù–û!)
```

**–í–∞–∂–Ω–æ:** –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä `[DRY-RUN]` –∏–ª–∏ `[LIVE]` –≤—Å–µ–≥–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ NotificationQueue

```python
from src.telegram_bot.notifier import NotificationQueue, Priority

queue = NotificationQueue()

# –¢–æ—Ä–≥–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–º–µ—é—Ç –≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
await queue.put(
    notification_func,
    priority=Priority.HIGH  # –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏
)
```

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–∞—è –ø–æ–∫—É–ø–∫–∞

```python
from src.utils.trading_notifier import TradingNotifier

async def simple_purchase():
    notifier = TradingNotifier(api, bot, queue, user_id=123)

    result = await notifier.buy_item_with_notifications(
        item_id="abc123",
        item_name="AWP | Asiimov (Field-Tested)",
        buy_price=50.00,
        sell_price=55.00,
        profit_usd=3.65,  # –ü–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–∏ 7%
        profit_percent=7.3,
        source="manual"
    )

    return result
```

### –ü—Ä–∏–º–µ—Ä 2: Batch-–ø–æ–∫—É–ø–∫–∞

```python
async def batch_purchase(items_list):
    """–ö—É–ø–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏."""
    notifier = TradingNotifier(api, bot, queue, user_id=123)
    results = []

    for item in items_list:
        result = await notifier.buy_item_with_notifications(
            item_id=item["id"],
            item_name=item["name"],
            buy_price=item["buy_price"],
            sell_price=item["sell_price"],
            profit_usd=item["profit"],
            profit_percent=item["profit_percent"],
            source="batch_scanner"
        )
        results.append(result)

        # –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è rate limit
        await asyncio.sleep(3)

    return results
```

### –ü—Ä–∏–º–µ—Ä 3: –ü—Ä–æ–¥–∞–∂–∞ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º

```python
async def sell_with_notification(item_id, item_name, buy_price, sell_price):
    """–ü—Ä–æ–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º."""
    notifier = TradingNotifier(api, bot, queue, user_id=123)

    result = await notifier.sell_item_with_notifications(
        item_id=item_id,
        item_name=item_name,
        buy_price=buy_price,
        sell_price=sell_price
    )

    return result
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å DRY-RUN=true**
2. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ 48-72 —á–∞—Å–∞** –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –Ω–∞ —Ä–µ–∞–ª—å–Ω—É—é —Ç–æ—Ä–≥–æ–≤–ª—é
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
4. **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –ª–∏–º–∏—Ç—ã** –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫ –≤ –¥–µ–Ω—å
5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É –æ—Ç–º–µ–Ω—ã** –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```python
import structlog

logger = structlog.get_logger(__name__)

# –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
logger.info(
    "buy_intent_notification_sent",
    user_id=user_id,
    item_id=item_id,
    buy_price=buy_price,
    dry_run=dry_run
)
```

---

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

```python
# –í–∫–ª—é—á–∏—Ç—å DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
import logging
logging.basicConfig(level=logging.DEBUG)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
await send_buy_intent_notification(
    bot=bot,
    user_id=YOUR_USER_ID,
    item_name="Test Item",
    buy_price=10.0,
    sell_price=11.0,
    profit_usd=0.30,
    profit_percent=3.0,
    source="test",
    dry_run=True,
    notification_queue=queue,
    item_id="test_123"
)
```

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ü—Ä–æ–±–ª–µ–º–∞**: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `user_id`, —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `register_notification_handlers` –≤—ã–∑–≤–∞–Ω

**–ü—Ä–æ–±–ª–µ–º–∞**: DRY-RUN –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `dry_run` –≤ —Ñ—É–Ω–∫—Ü–∏–∏

---

## üìö API Reference

### send_buy_intent_notification

```python
async def send_buy_intent_notification(
    bot: Bot,
    user_id: int,
    item_name: str,
    buy_price: float,
    sell_price: float,
    profit_usd: float,
    profit_percent: float,
    source: str,
    dry_run: bool,
    notification_queue: NotificationQueue,
    item_id: str,
) -> None:
    """–û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–∞–º–µ—Ä–µ–Ω–∏–∏ –∫—É–ø–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç.

    Args:
        bot: Telegram Bot instance
        user_id: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
        item_name: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞
        buy_price: –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ (USD)
        sell_price: –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ (USD)
        profit_usd: –ü—Ä–∏–±—ã–ª—å –≤ USD
        profit_percent: –ü—Ä–∏–±—ã–ª—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
        source: –ò—Å—Ç–æ—á–Ω–∏–∫ (arbitrage_scanner, manual, etc.)
        dry_run: –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (True) –∏–ª–∏ —Ä–µ–∞–ª—å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è (False)
        notification_queue: –û—á–µ—Ä–µ–¥—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        item_id: ID –ø—Ä–µ–¥–º–µ—Ç–∞ –¥–ª—è –æ—Ç–º–µ–Ω—ã –ø–æ–∫—É–ø–∫–∏
    """
```

### TradingNotifier.buy_item_with_notifications

```python
async def buy_item_with_notifications(
    self,
    item_id: str,
    item_name: str,
    buy_price: float,
    sell_price: float,
    profit_usd: float,
    profit_percent: float,
    source: str = "arbitrage_scanner",
) -> dict[str, Any]:
    """–ö—É–ø–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

    Args:
        item_id: ID –ø—Ä–µ–¥–º–µ—Ç–∞
        item_name: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞
        buy_price: –¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏
        sell_price: –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏
        profit_usd: –ü—Ä–∏–±—ã–ª—å –≤ USD
        profit_percent: –ü—Ä–∏–±—ã–ª—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
        source: –ò—Å—Ç–æ—á–Ω–∏–∫ –æ–ø–µ—Ä–∞—Ü–∏–∏

    Returns:
        –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∫—É–ø–∫–∏ –æ—Ç DMarketAPI
    """
```

---

## üìù Changelog

### v1.0 (19 –Ω–æ—è–±—Ä—è 2025)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã 4 —Ç–∏–ø–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω TradingNotifier wrapper
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã –ø–æ–∫—É–ø–∫–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä DRY-RUN/LIVE
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã callback-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**: 1.0
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 19 –Ω–æ—è–±—Ä—è 2025 –≥.
