# üîß Troubleshooting Guide - DMarket Telegram Bot

**–í–µ—Ä—Å–∏—è**: 1.0.0
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –Ø–Ω–≤–∞—Ä—å 2026 –≥.

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
2. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–≥—Ä–∞—Ü–∏–∏](#-–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö-–∏-–º–∏–≥—Ä–∞—Ü–∏–∏)
3. [DMarket API](#-dmarket-api)
4. [Telegram Bot](#-telegram-bot)
5. [–ê–≤—Ç–æ-–ø–æ–∫—É–ø–∫–∞ (Auto-Buy)](#-–∞–≤—Ç–æ-–ø–æ–∫—É–ø–∫–∞-auto-buy)
6. [–ü—Ä—è–º–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è (Direct Buy/Sell)](#-–ø—Ä—è–º–∞—è-—Ç–æ—Ä–≥–æ–≤–ª—è-direct-buysell)
7. [WebSocket](#-websocket)
8. [–õ–æ–≥–∏ –∏ —Ç–µ—Å—Ç—ã](#-–ª–æ–≥–∏-–∏-—Ç–µ—Å—Ç—ã)
9. [Docker](#-docker)

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü—Ä–æ–±–ª–µ–º–∞: "–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
‚ùå TELEGRAM_BOT_TOKEN not set or empty
```

**–†–µ—à–µ–Ω–∏–µ**:

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `.env` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `.env`

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ .env (Linux/macOS)
cat .env

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ .env (Windows)
type .env

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -c "import os; print(os.getenv('TELEGRAM_BOT_TOKEN'))"
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "–ò–º–ø–æ—Ä—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
ModuleNotFoundError: No module named 'src'
```

**–†–µ—à–µ–Ω–∏–µ**:

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ
which python  # Linux/macOS
where python  # Windows

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
pip install -e .
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –≤ –∫–æ–º–∞–Ω–¥–∞—Ö

**–°–∏–º–ø—Ç–æ–º—ã**:

```bash
—Ä—Ét–µst tests/  # –û—à–∏–±–∫–∞: —Ä—É—Å—Å–∫–∏–µ "—Ä", "—É", "–µ"
```

**–†–µ—à–µ–Ω–∏–µ**:

1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π (`Win + –ü—Ä–æ–±–µ–ª ‚Üí EN`)
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ ASCII —Å–∏–º–≤–æ–ª—ã –≤ –∫–æ–º–∞–Ω–¥–∞—Ö
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —à—Ä–∏—Ñ—Ç —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–ª–∏—á–∏–µ–º —Å–∏–º–≤–æ–ª–æ–≤ (Cascadia Code, Fira Code)

```bash
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
pytest tests/
python -m src.main

# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
—Ä—Ét–µst tests/
—Ä—Éth–æn -m src.main
```

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞: "–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
‚ùå Database connection failed
```

**–†–µ—à–µ–Ω–∏–µ –¥–ª—è SQLite**:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É—Ç—å –∫ –ë–î
python -c "from src.utils.config import Config; print(Config.load().database.url)"

# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ë–î, –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
mkdir -p data

# –ü–æ–≤—Ç–æ—Ä–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ë–î
python scripts/init_db.py
```

**–†–µ—à–µ–Ω–∏–µ –¥–ª—è PostgreSQL**:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å PostgreSQL
psql -h localhost -U your_user -l

# –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
createdb dmarket_bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
python -c "from src.utils.config import Config; print(Config.load().database.url)"
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "Target database is not up to date"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
alembic.util.exc.CommandError: Target database is not up to date.
```

**–†–µ—à–µ–Ω–∏–µ**:

```bash
# –ü–æ–º–µ—Ç–∏—Ç—å –ë–î –∫–∞–∫ –∞–∫—Ç—É–∞–ª—å–Ω—É—é
alembic stamp head

# –ò–ª–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "Multiple head revisions are present"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
FAILED: Multiple head revisions are present
```

**–†–µ—à–µ–Ω–∏–µ**:

```bash
# –°–æ–∑–¥–∞—Ç—å merge –º–∏–≥—Ä–∞—Ü–∏—é
alembic merge -m "Merge heads" <rev1> <rev2>

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å merge
alembic upgrade head
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–∫–∞—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table
```

**–†–µ—à–µ–Ω–∏–µ**:
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç–æ–¥ `downgrade()` –≤ –º–∏–≥—Ä–∞—Ü–∏–∏ - –æ–Ω –¥–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É–¥–∞–ª—è—Ç—å —Ç–∞–±–ª–∏—Ü—ã –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:

```python
def downgrade():
    """–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —É–¥–∞–ª–µ–Ω–∏—è."""
    # –°–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç—å foreign keys
    op.drop_constraint('fk_user_settings_user_id', 'user_settings')
    # –ó–∞—Ç–µ–º –∏–Ω–¥–µ–∫—Å—ã
    op.drop_index('ix_user_settings_user_id')
    # –ü–æ—Ç–æ–º —Ç–∞–±–ª–∏—Ü—ã
    op.drop_table('user_settings')
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "ALTER COLUMN is not supported by SQLite"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
NotImplementedError: ALTER COLUMN is not supported by SQLite
```

**–†–µ—à–µ–Ω–∏–µ**:
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `batch_alter_table`:

```python
def upgrade():
    with op.batch_alter_table('users') as batch_op:
        batch_op.alter_column(
            'email',
            type_=sa.String(255),
            existing_type=sa.String(100)
        )
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: Autogenerate –Ω–µ –≤–∏–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ**:
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –º–æ–¥–µ–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ `alembic/env.py`:

```python
# alembic/env.py
from src.models import User, Target, Trade  # –í—Å–µ –º–æ–¥–µ–ª–∏!
from src.utils.database import Base

target_metadata = Base.metadata
```

---

## üì° DMarket API

### –ü—Ä–æ–±–ª–µ–º–∞: "DMarket API –æ—à–∏–±–∫–∞ 401 Unauthorized"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
‚ùå DMarket API: Authentication failed (401)
```

**–†–µ—à–µ–Ω–∏–µ**:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–µ–π:

   ```bash
   python scripts/validate_config.py
   ```

2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–ª—é—á–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤)

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∫–ª—é—á–µ–π –Ω–∞ [DMarket](https://dmarket.com/profile/api)

4. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–µ –∫–ª—é—á–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

---

### –ü—Ä–æ–±–ª–µ–º–∞: "Rate limit exceeded (429)"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
‚ùå DMarket API: Rate limit exceeded (429)
```

**–†–µ—à–µ–Ω–∏–µ**:

- DMarket –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç ~30 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ –º–∏–Ω—É—Ç—É –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–æ–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ rate limiting:

```python
# src/utils/rate_limiter.py
max_calls=30,
time_period=60  # seconds
```

---

## ü§ñ Telegram Bot

### –ü—Ä–æ–±–ª–µ–º–∞: "Telegram API –æ—à–∏–±–∫–∞: Invalid token"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
‚ùå Telegram API: Invalid bot token
```

**–†–µ—à–µ–Ω–∏–µ**:

1. –ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –æ—Ç [@BotFather](https://t.me/BotFather):
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
   - –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω

2. –û–±–Ω–æ–≤–∏—Ç–µ `.env`:

   ```env
   TELEGRAM_BOT_TOKEN=123456789:ABCDefGHIjklMNOpqrsTUVwxyz
   ```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

---

## üõí –ê–≤—Ç–æ-–ø–æ–∫—É–ø–∫–∞ (Auto-Buy)

### –ü—Ä–æ–±–ª–µ–º–∞: "–ê–≤—Ç–æ-–ø–æ–∫—É–ø–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"

**–°–∏–º–ø—Ç–æ–º—ã**: –ë–æ—Ç –Ω–∞—Ö–æ–¥–∏—Ç –≤—ã–≥–æ–¥–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã, –Ω–æ –Ω–µ –ø–æ–∫—É–ø–∞–µ—Ç –∏—Ö

**–†–µ—à–µ–Ω–∏–µ**:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∞–≤—Ç–æ-–ø–æ–∫—É–ø–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞**:

   ```env
   AUTO_BUY_ENABLED=true
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∂–∏–º DRY_RUN**:

   ```env
   DRY_RUN=false  # ‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: —Ä–µ–∞–ª—å–Ω—ã–µ —Å–¥–µ–ª–∫–∏!
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã**:

   ```env
   MAX_TRADE_VALUE=50.00
   DAILY_TRADE_LIMIT=500.00
   MIN_PROFIT_PERCENT=5.0
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å**:

   ```bash
   /balance  # –≤ Telegram
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü—Ä–µ–¥–º–µ—Ç—ã –Ω–µ –ø–æ–∫—É–ø–∞—é—Ç—Å—è –∏–∑-–∑–∞ –ø–æ—Ä–æ–≥–∞ —Å–∫–∏–¥–∫–∏"

**–°–∏–º–ø—Ç–æ–º—ã**: –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç `Discount threshold not met`

**–†–µ—à–µ–Ω–∏–µ**:

```env
# –£–º–µ–Ω—å—à–∏—Ç–µ –ø–æ—Ä–æ–≥ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å–∫–∏–¥–∫–∏
MIN_DISCOUNT_PERCENT=3.0  # –ë—ã–ª–æ 5.0
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü—Ä–µ–¥–º–µ—Ç—ã —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–∏–µ"

**–°–∏–º–ø—Ç–æ–º—ã**: –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç `Price exceeds MAX_ITEM_PRICE`

**–†–µ—à–µ–Ω–∏–µ**:

```env
# –£–≤–µ–ª–∏—á—å—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É
MAX_ITEM_PRICE=100.00  # –ë—ã–ª–æ 50.00
```

---

## üí∞ –ü—Ä—è–º–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è (Direct Buy/Sell)

### –ü—Ä–æ–±–ª–µ–º–∞: "–ë–æ—Ç –Ω–µ –ø–æ–∫—É–ø–∞–µ—Ç –ø—Ä–µ–¥–º–µ—Ç—ã"

**–ß–µ–∫–ª–∏—Å—Ç**:

- [ ] `DRY_RUN=false` –≤ `.env`
- [ ] `Available balance > 0` (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å `/balance`)
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ 401 –≤ –ª–æ–≥–∞—Ö (API –∫–ª—é—á–∏ –≤–∞–ª–∏–¥–Ω—ã)
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ 429 (rate limit –Ω–µ –ø—Ä–µ–≤—ã—à–µ–Ω)

**–†–µ—à–µ–Ω–∏–µ**:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
tail -f logs/dmarket_bot.log | grep -i "buy\|error"
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü—Ä–µ–¥–º–µ—Ç—ã –Ω–µ –≤—ã—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ –ø—Ä–æ–¥–∞–∂—É"

**–ß–µ–∫–ª–∏—Å—Ç**:

- [ ] Inventory Manager –∑–∞–ø—É—â–µ–Ω
- [ ] –ü—Ä–µ–¥–º–µ—Ç—ã –≤ —Å—Ç–∞—Ç—É—Å–µ `at_inventory` (–Ω–µ –≤ trade lock)
- [ ] –¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ –≤—ã—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π

**–†–µ—à–µ–Ω–∏–µ**:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
/inventory  # –≤ Telegram
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "Undercutting –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"

**–°–∏–º–ø—Ç–æ–º—ã**: –¶–µ–Ω—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–†–µ—à–µ–Ω–∏–µ**:

```env
# –í–∫–ª—é—á–∏—Ç–µ undercutting
UNDERCUT_ENABLED=true
UNDERCUT_INTERVAL=300  # –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
UNDERCUT_AMOUNT=0.01   # –ù–∞ $0.01 –Ω–∏–∂–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**:

- –ï—Å—Ç—å –ª–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –ª–æ—Ç—ã –Ω–∞ –ø—Ä–æ–¥–∞–∂—É
- `MIN_PROFIT_MARGIN` –Ω–µ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–π

---

## üîå WebSocket

### –ü—Ä–æ–±–ª–µ–º–∞: "WebSocket –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è"

**–°–∏–º–ø—Ç–æ–º—ã**: –õ–æ–≥–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –æ reconnect

**–†–µ—à–µ–Ω–∏–µ**:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
2. –£–≤–µ–ª–∏—á—å—Ç–µ –∑–∞–¥–µ—Ä–∂–∫—É –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

   ```env
   WS_RECONNECT_DELAY=10  # –ë—ã–ª–æ 5
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –≤–æ–æ–±—â–µ"

**–†–µ—à–µ–Ω–∏–µ**:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é DMarket API - –≤–æ–∑–º–æ–∂–Ω–æ, —ç–Ω–¥–ø–æ–∏–Ω—Ç –∏–∑–º–µ–Ω–∏–ª—Å—è
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ polling —Ä–µ–∂–∏–º:

   ```env
   USE_POLLING=true
   POLLING_INTERVAL=2
   ```

3. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π DMarket

---

### –ü—Ä–æ–±–ª–µ–º–∞: "Health alert 'WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω'"

**–°–∏–º–ø—Ç–æ–º—ã**: –ê–ª–µ—Ä—Ç –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏:

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è polling —Ä–µ–∂–∏–º
- WebSocket —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–†–µ—à–µ–Ω–∏–µ**: –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ polling –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ, –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–ª–µ—Ä—Ç:

```env
WS_HEALTH_ALERT_ENABLED=false
```

---

### WebSocket vs Polling - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –ú–µ—Ç—Ä–∏–∫–∞         | WebSocket       | Polling    |
| --------------- | --------------- | ---------- |
| –ó–∞–¥–µ—Ä–∂–∫–∞        | <50ms           | 1-2s       |
| –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ API | –ù–∏–∑–∫–∞—è          | –°—Ä–µ–¥–Ω—è—è    |
| –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å      | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ—Ç–∏ | –í—ã—Å–æ–∫–∞—è    |
| –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è   | Production      | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ |

---

## üìù –õ–æ–≥–∏ –∏ —Ç–µ—Å—Ç—ã

### –ü—Ä–æ–±–ª–µ–º–∞: "–õ–æ–≥–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è"

**–°–∏–º–ø—Ç–æ–º—ã**: –§–∞–π–ª—ã –ª–æ–≥–æ–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –ø–∞–ø–∫–µ `logs/`

**–†–µ—à–µ–Ω–∏–µ**:

```bash
# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ª–æ–≥–æ–≤
mkdir -p logs

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (Linux/macOS)
chmod 755 logs

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
python -c "from src.utils.config import Config; print(Config.load().logging)"
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "–¢–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
FAILED tests/test_main.py::test_initialize_success
```

**–†–µ—à–µ–Ω–∏–µ**:

```bash
# –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
pip install pytest pytest-asyncio pytest-cov

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
pytest -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
pytest tests/test_main.py::test_initialize_success -v

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ
pytest --cov=src --cov-report=html
```

---

## üê≥ Docker

### –ü—Ä–æ–±–ª–µ–º–∞: "Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
Error: Cannot start container
```

**–†–µ—à–µ–Ω–∏–µ**:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose logs bot

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑
docker-compose build --no-cache

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å docker-compose.yml
docker-compose config

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ —Ä–µ–∂–∏–º–µ debug
docker-compose up
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–∞–¥–∞–µ—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞"

**–†–µ—à–µ–Ω–∏–µ**:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å exit code
docker-compose ps

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
docker-compose run --rm bot bash

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker-compose run --rm bot env | grep -E "TELEGRAM|DMARKET"
```

---

## üêç Python —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: "SyntaxError: unterminated triple-quoted string literal"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
SyntaxError: unterminated triple-quoted string literal (detected at line N)
```

**–ü—Ä–∏—á–∏–Ω–∞**: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–ª–∏ –Ω–µ–∑–∞–∫—Ä—ã—Ç—ã–µ —Ç—Ä–æ–π–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ `"""` –≤ docstring.

**–ü—Ä–∏–º–µ—Ä –æ—à–∏–±–∫–∏** (—Ä–µ–∞–ª—å–Ω—ã–π —Å–ª—É—á–∞–π –∏–∑ `src/telegram_bot/keyboards/settings.py`):

```python
def my_function():
    """Docstring –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∑–¥–µ—Å—å.
    """
    """  # ‚Üê –û—à–∏–±–∫–∞! –õ–∏—à–Ω–∏–µ —Ç—Ä–æ–π–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏
    return "result"
```

**–†–µ—à–µ–Ω–∏–µ**:

1. –ù–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª —Å –æ—à–∏–±–∫–æ–π:

   ```bash
   python -m py_compile src/telegram_bot/keyboards/settings.py
   ```

2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∏ –Ω–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É —Å –æ—à–∏–±–∫–æ–π

3. –£–¥–∞–ª–∏—Ç–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ `"""` –∏–ª–∏ –∏—Å–ø—Ä–∞–≤—å—Ç–µ docstring

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
python -m py_compile –ø—É—Ç—å/–∫/—Ñ–∞–π–ª—É.py

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
python -m compileall src/ -q

# –ï—Å–ª–∏ –æ—à–∏–±–æ–∫ –Ω–µ—Ç - –≤—ã–≤–æ–¥ –±—É–¥–µ—Ç –ø—É—Å—Ç—ã–º
# –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∞ - –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–∞ —Å—Ç—Ä–æ–∫–∞ —Å –ø—Ä–æ–±–ª–µ–º–æ–π
```

**–í–∞–∂–Ω–æ**: –û—Ç–ª–∏—á–∞–π—Ç–µ **—Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏** –æ—Ç **–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –ª–∏–Ω—Ç–µ—Ä–∞**:

| –¢–∏–ø          | –ü—Ä–∏–º–µ—Ä                             | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å         |
| ------------ | ---------------------------------- | ------------------- |
| Syntax Error | `SyntaxError: unterminated string` | ‚ùå –ö–æ–¥ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è |
| Lint Warning | `Line too long (120 > 100)`        | ‚ö†Ô∏è –°—Ç–∏–ª—å, —Ä–∞–±–æ—Ç–∞–µ—Ç   |
| Type Warning | `Incompatible types`               | ‚ö†Ô∏è MyPy, —Ä–∞–±–æ—Ç–∞–µ—Ç    |

---

### –ü—Ä–æ–±–ª–µ–º–∞: "IndentationError: unexpected indent"

**–°–∏–º–ø—Ç–æ–º—ã**:

```text
IndentationError: unexpected indent
```

**–†–µ—à–µ–Ω–∏–µ**:

1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã (–Ω–µ —Ç–∞–±—ã) –¥–ª—è –æ—Ç—Å—Ç—É–ø–æ–≤
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ—Ç—Å—Ç—É–ø–æ–≤ (4 –ø—Ä–æ–±–µ–ª–∞)
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä:

   ```json
   // .vscode/settings.json
   {
       "editor.tabSize": 4,
       "editor.insertSpaces": true,
       "editor.detectIndentation": false
   }
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –õ–∏–Ω—Ç–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç—ã—Å—è—á–∏ –æ—à–∏–±–æ–∫

**–°–∏–º–ø—Ç–æ–º—ã**: Ruff/Flake8 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 1000+ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –ß–∞—Å—Ç–æ —ç—Ç–æ:

- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–∞—Ö –≤ —Å—Ç—Ä–æ–∫–∞—Ö (–ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è)
- –°—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (line length, etc.)

**–†–µ—à–µ–Ω–∏–µ**:

1. –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏:

   ```bash
   # –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
   python -m py_compile src/—Ñ–∞–π–ª.py

   # –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ Ruff
   ruff check src/ --select=E9,F63,F7,F82
   ```

2. –ò–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ `pyproject.toml`:

   ```toml
   [tool.ruff.lint]
   ignore = ["RUF001", "RUF002", "RUF003"]  # –ö–∏—Ä–∏–ª–ª–∏—Ü–∞ –≤ —Å—Ç—Ä–æ–∫–∞—Ö
   ```

---

## üÜò –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –æ–ø–∏—Å–∞–Ω–∞ –≤ —ç—Ç–æ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏**: `logs/dmarket_bot.log`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Sentry**: –û—à–∏–±–∫–∏ –∏ —Ç—Ä–µ–π—Å—ã (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
3. **–°–æ–∑–¥–∞–π—Ç–µ Issue**: [GitHub Issues](https://github.com/Dykij/DMarket-Telegram-Bot/issues)

**–§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ**:

```markdown
**–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã**: –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

**–®–∞–≥–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è**:
1. –®–∞–≥ 1
2. –®–∞–≥ 2
3. –®–∞–≥ 3

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**: –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏

**–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**: –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ

**–û–∫—Ä—É–∂–µ–Ω–∏–µ**:
- –û–°: Windows 10 / Ubuntu 22.04 / macOS 13
- Python –≤–µ—Ä—Å–∏—è: 3.11.5
- –í–µ—Ä—Å–∏—è –±–æ—Ç–∞: 1.0

**–õ–æ–≥–∏** (–µ—Å–ª–∏ –µ—Å—Ç—å):
```

<paste logs here>
```
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](docs/QUICK_START.md)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](docs/ARCHITECTURE.md)
- [DMarket API](docs/DMARKET_API_FULL_SPEC.md)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](docs/SECURITY.md)
- [–ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î](docs/DATABASE_MIGRATIONS.md)

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**: 1.0.0
**–°–æ–∑–¥–∞–Ω**: –Ø–Ω–≤–∞—Ä—å 2026 –≥.
