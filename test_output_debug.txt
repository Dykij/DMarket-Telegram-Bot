STDOUT:
============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-8.4.2, pluggy-1.6.0 -- D:\Dmarket\DMarket-Telegram-Bot\DMarket-Telegram-Bot\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: D:\Dmarket\DMarket-Telegram-Bot\DMarket-Telegram-Bot
configfile: pyproject.toml
plugins: anyio-4.11.0, Faker-38.0.0, asyncio-1.3.0, cov-7.0.0, httpx-0.35.0, mock-3.15.1, xdist-3.8.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collecting ... collected 1 item

tests/telegram_bot/handlers/test_market_alerts_handler.py::TestAlertsCommand::test_alerts_command_exception_handling FAILED

================================== FAILURES ===================================
__________ TestAlertsCommand.test_alerts_command_exception_handling ___________

self = <tests.telegram_bot.handlers.test_market_alerts_handler.TestAlertsCommand object at 0x00000290CCAD8650>
mock_update = <MagicMock spec='Update' id='2820933173456'>
mock_context = <MagicMock spec='CallbackContext' id='2820933291664'>

    @pytest.mark.asyncio()
    async def test_alerts_command_exception_handling(self, mock_update, mock_context):
        """╥хёЄ юсЁрсюЄъш шёъы■ўхэшщ т ъюьрэфх /alerts."""
        with patch(
            "src.telegram_bot.handlers.market_alerts_handler.get_alerts_manager",
            side_effect=Exception("Test error"),
        ):
>           await alerts_command(mock_update, mock_context)

tests\telegram_bot\handlers\test_market_alerts_handler.py:121: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

args = (<MagicMock spec='Update' id='2820933173456'>, <MagicMock spec='CallbackContext' id='2820933291664'>)
kwargs = {}
error_details = {'exception_type': 'Exception', 'traceback': ['Traceback (most recent call last):', '  File "D:\\Dmarket\\DMarket-Tele...rket_alerts_handler.py", line 61, in alerts_command', '    alerts_manager = get_alerts_manager(bot=context.bot)', ...]}

    @functools.wraps(func)
    async def async_wrapper(*args: Any, **kwargs: Any) -> Any:
        try:
>           return await func(*args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^

src\utils\exceptions.py:529: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

update = <MagicMock spec='Update' id='2820933173456'>
context = <MagicMock spec='CallbackContext' id='2820933291664'>

    @handle_exceptions(
        logger_instance=logger,
        default_error_message="╬°шсър яЁш юсЁрсюЄъх ъюьрэф√ /alerts",
    )
    async def alerts_command(
        update: Update,
        context: ContextTypes.DEFAULT_TYPE,
    ) -> None:
        """╬сЁрсрЄ√трхЄ ъюьрэфє /alerts фы  єяЁртыхэш  яюфяшёърьш эр єтхфюьыхэш .
    
        Args:
            update: ╬с·хъЄ юсэютыхэш  юЄ Telegram
            context: ╩юэЄхъёЄ сюЄр
    
        """
        if not update.effective_user or not update.message:
            return
        user_id = update.effective_user.id
    
        # ╧юыєўрхь ьхэхфцхЁ єтхфюьыхэшщ
        # ╧хЁхфрхь bot шч context, хёыш ьхэхфцхЁ х∙х эх шэшЎшрышчшЁютрэ
>       alerts_manager = get_alerts_manager(bot=context.bot)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

src\telegram_bot\handlers\market_alerts_handler.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <MagicMock name='get_alerts_manager' id='2820933323152'>, args = ()
kwargs = {'bot': <MagicMock name='mock.bot' id='2820933340816'>}

    def __call__(self, /, *args, **kwargs):
        # can't use self in-case a function / method we are mocking uses self
        # in the signature
        self._mock_check_sig(*args, **kwargs)
        self._increment_mock_call(*args, **kwargs)
>       return self._mock_call(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

C:\Program Files\Python311\Lib\unittest\mock.py:1124: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <MagicMock name='get_alerts_manager' id='2820933323152'>, args = ()
kwargs = {'bot': <MagicMock name='mock.bot' id='2820933340816'>}

    def _mock_call(self, /, *args, **kwargs):
>       return self._execute_mock_call(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

C:\Program Files\Python311\Lib\unittest\mock.py:1128: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <MagicMock name='get_alerts_manager' id='2820933323152'>, args = ()
kwargs = {'bot': <MagicMock name='mock.bot' id='2820933340816'>}
effect = Exception('Test error')

    def _execute_mock_call(self, /, *args, **kwargs):
        # separate from _increment_mock_call so that awaited functions are
        # executed separately from their call, also AsyncMock overrides this method
    
        effect = self.side_effect
        if effect is not None:
            if _is_exception(effect):
>               raise effect
E               Exception: Test error

C:\Program Files\Python311\Lib\unittest\mock.py:1183: Exception
----------------------------- Captured log setup ------------------------------
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.address`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.address` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.automotive`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.automotive` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.bank`.
DEBUG    faker.factory:factory.py:88 Specified locale `en_US` is not available for provider `faker.providers.bank`. Locale reset to `en_GB` for this provider.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.barcode`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.barcode` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.color`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.color` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.company`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.company` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.credit_card`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.credit_card` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.currency`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.currency` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.date_time`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.date_time` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:108 Provider `faker.providers.doi` does not feature localization. Specified locale `en_US` is not used for this provider.
DEBUG    faker.factory:factory.py:108 Provider `faker.providers.emoji` does not feature localization. Specified locale `en_US` is not used for this provider.
DEBUG    faker.factory:factory.py:108 Provider `faker.providers.file` does not feature localization. Specified locale `en_US` is not used for this provider.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.geo`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.geo` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.internet`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.internet` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.isbn`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.isbn` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.job`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.job` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.lorem`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.lorem` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.misc`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.misc` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.passport`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.passport` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.person`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.person` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.phone_number`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.phone_number` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:108 Provider `faker.providers.profile` does not feature localization. Specified locale `en_US` is not used for this provider.
DEBUG    faker.factory:factory.py:108 Provider `faker.providers.python` does not feature localization. Specified locale `en_US` is not used for this provider.
DEBUG    faker.factory:factory.py:108 Provider `faker.providers.sbn` does not feature localization. Specified locale `en_US` is not used for this provider.
DEBUG    faker.factory:factory.py:78 Looking for locale `en_US` in provider `faker.providers.ssn`.
DEBUG    faker.factory:factory.py:97 Provider `faker.providers.ssn` has been localized to `en_US`.
DEBUG    faker.factory:factory.py:108 Provider `faker.providers.user_agent` does not feature localization. Specified locale `en_US` is not used for this provider.
DEBUG    asyncio:proactor_events.py:633 Using proactor: IocpProactor
DEBUG    asyncio:proactor_events.py:633 Using proactor: IocpProactor
------------------------------ Captured log call ------------------------------
ERROR    src.telegram_bot.handlers.market_alerts_handler:exceptions.py:544 ═хюсЁрсюЄрээюх шёъы■ўхэшх т alerts_command: Test error
Traceback (most recent call last):
  File "D:\Dmarket\DMarket-Telegram-Bot\DMarket-Telegram-Bot\src\utils\exceptions.py", line 529, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Dmarket\DMarket-Telegram-Bot\DMarket-Telegram-Bot\src\telegram_bot\handlers\market_alerts_handler.py", line 61, in alerts_command
    alerts_manager = get_alerts_manager(bot=context.bot)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\unittest\mock.py", line 1124, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\unittest\mock.py", line 1128, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\unittest\mock.py", line 1183, in _execute_mock_call
    raise effect
Exception: Test error
============================ slowest 10 durations =============================
0.13s setup    tests/telegram_bot/handlers/test_market_alerts_handler.py::TestAlertsCommand::test_alerts_command_exception_handling
0.01s call     tests/telegram_bot/handlers/test_market_alerts_handler.py::TestAlertsCommand::test_alerts_command_exception_handling
0.00s teardown tests/telegram_bot/handlers/test_market_alerts_handler.py::TestAlertsCommand::test_alerts_command_exception_handling
=========================== short test summary info ===========================
FAILED tests/telegram_bot/handlers/test_market_alerts_handler.py::TestAlertsCommand::test_alerts_command_exception_handling - Exception: Test error
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!
============================== 1 failed in 1.07s ==============================


STDERR:


Return code: 1
