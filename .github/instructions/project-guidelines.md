# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è GitHub Copilot

## üéØ –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Python-–±–æ—Ç –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ DMarket —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
- –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ –∞—Ä–±–∏—Ç—Ä–∞–∂–∞ (5 —É—Ä–æ–≤–Ω–µ–π)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–∞—Ä–≥–µ—Ç–æ–≤ (buy orders)
- Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ü–µ–Ω —á–µ—Ä–µ–∑ WebSocket
- Multi-game –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (CS:GO, Dota 2, TF2, Rust)

## üìù –ü—Ä–∞–≤–∏–ª–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
- **–í–°–ï–ì–î–ê** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `async/await` –¥–ª—è I/O –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—Ç—å `httpx.AsyncClient` –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `asyncio.gather()` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### –¢–∏–ø–∏–∑–∞—Ü–∏—è
- **–í–°–ï–ì–î–ê** –¥–æ–±–∞–≤–ª—è—Ç—å –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å: `list[str]`, `dict[str, int]`
- –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–∑–¥–∞–≤–∞—Ç—å `TypeAlias`

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–Ω–µ –≥–æ–ª—ã–µ `except:`)
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –æ—à–∏–±–∫–∏ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- –ü—Ä–∏–º–µ–Ω—è—Ç—å `tenacity` –¥–ª—è retry –ª–æ–≥–∏–∫–∏

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `structlog` –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–æ–≥–æ–≤
- **–ù–ï** –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (API –∫–ª—é—á–∏, —Ç–æ–∫–µ–Ω—ã)
- –í–∫–ª—é—á–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç: `user_id`, `item_id`, `request_id`

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `pytest` –∏ `pytest-asyncio`
- –ú–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ API –≤—ã–∑–æ–≤—ã
- –°—Ç—Ä–µ–º–∏—Ç—å—Å—è –∫ –ø–æ–∫—Ä—ã—Ç–∏—é 80%+

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Google Style –¥–ª—è docstrings
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –í–∫–ª—é—á–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ù–ò–ö–û–ì–î–ê** –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ `.env`
- –®–∏—Ñ—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ API –∫–ª—é—á–∏ –≤ –ë–î
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## üé® –°—Ç–∏–ª—å –∫–æ–¥–∞

- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: **Ruff** (88 —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ —Å—Ç—Ä–æ–∫—É)
- –õ–∏–Ω—Ç–∏–Ω–≥: **Ruff** —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∏–∑ `pyproject.toml`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤: **MyPy** –≤ –±–∞–∑–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤: **Ruff** (isort-—Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è)

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

```
src/
‚îú‚îÄ‚îÄ dmarket/          # API –∫–ª–∏–µ–Ω—Ç –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ dmarket_api.py
‚îÇ   ‚îú‚îÄ‚îÄ arbitrage_scanner.py
‚îÇ   ‚îî‚îÄ‚îÄ targets.py
‚îú‚îÄ‚îÄ telegram_bot/     # Telegram –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îî‚îÄ‚îÄ commands/
‚îú‚îÄ‚îÄ models/           # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îî‚îÄ‚îÄ utils/            # –£—Ç–∏–ª–∏—Ç—ã
```

## üí° –ü—Ä–∏–º–µ—Ä—ã —à–∞–±–ª–æ–Ω–æ–≤

### Async —Ñ—É–Ω–∫—Ü–∏—è —Å —Ç–∏–ø–∞–º–∏
```python
async def fetch_market_data(
    item_id: str,
    game: str = "csgo"
) -> dict[str, Any]:
    """–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–µ–¥–º–µ—Ç–µ —Å —Ä—ã–Ω–∫–∞.

    Args:
        item_id: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–∞
        game: –ö–æ–¥ –∏–≥—Ä—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: csgo)

    Returns:
        –°–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø—Ä–µ–¥–º–µ—Ç–µ

    Raises:
        APIError: –ü—Ä–∏ –æ—à–∏–±–∫–µ API –∑–∞–ø—Ä–æ—Å–∞
    """
    async with httpx.AsyncClient() as client:
        response = await client.get(f"/items/{item_id}")
        return response.json()
```

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
```python
async def arbitrage_command(
    update: Update,
    context: ContextTypes.DEFAULT_TYPE
) -> None:
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /arbitrage."""
    if not update.message:
        return

    user_id = update.effective_user.id
    logger.info("arbitrage_command_received", user_id=user_id)

    try:
        # –õ–æ–≥–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã
        await update.message.reply_text("‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç")
    except Exception as e:
        logger.error("arbitrage_command_failed", user_id=user_id, error=str(e))
        await update.message.reply_text("‚ùå –û—à–∏–±–∫–∞")
```

## üöÄ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

1. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å** - –∫–æ–¥ –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∑–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
4. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å** - –ø–æ–Ω—è—Ç–Ω—ã–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –∫–æ–¥
5. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ç–µ—Å—Ç–∞–º–∏

## ‚ö†Ô∏è –ò–∑–±–µ–≥–∞—Ç—å

- –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ async –∫–æ–¥–µ
- –ó–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–æ—Å–æ–±–µ–Ω–Ω–æ —Å–µ–∫—Ä–µ—Ç–æ–≤)
- –ì–æ–ª—ã—Ö `except:` –±–ª–æ–∫–æ–≤
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
- –ù–µ—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π (`raise Exception("error")`)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ç–∏–ø–æ–≤ –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö API
